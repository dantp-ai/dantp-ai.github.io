<!doctype html>
<html lang="en"><head>
    <title>How to set up a Python debugger in VS Code for pytest</title>
    
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="" />

    
    
    
    <link rel="stylesheet" href="../../../css/theme.min.css">

    
    
    
    
    <link rel="stylesheet" href="../../../css/custom.min.css">
    

    
</head>
<body>
        <div id="content" class="mx-auto"><header class="container mt-sm-5 mt-4 mb-4 mt-xs-1">
    <div class="row">
        
        <div class="col-sm-4 col-12 text-sm-right text-center pt-sm-4">
            <a href="../../../" class="text-decoration-none">
                <img id="home-image" class="rounded-circle"
                    
                        
                            src="../../../images/avatar.png"
                        
                    
                />
            </a>
        </div>
        <div class="col-sm-8 col-12 text-sm-left text-center">
        
            <h2 class="m-0 mb-2 mt-4">
                <a href="../../../" class="text-decoration-none">
                    
                        Dan
                    
                </a>
            </h2>
            <p class="text-muted mb-1">
                
                    AI Engineer
                
            </p>
            <ul id="nav-links" class="list-inline mb-2">
                
                
                    <li class="list-inline-item">
                        <a class="badge badge-white " href="../../../" title="About">About</a>
                    </li>
                
                    <li class="list-inline-item">
                        <a class="badge badge-white active" href="../../../posts/" title="Posts">Posts</a>
                    </li>
                
                    <li class="list-inline-item">
                        <a class="badge badge-white " href="../../../categories/" title="Categories">Categories</a>
                    </li>
                
            </ul>
            <ul id="nav-social" class="list-inline">
                
            </ul>
        </div>
    </div>
    <hr />
</header>
<div class="container">

    <div class="pl-sm-2">
        <div class="mb-3">
            <h3 class="mb-0">How to set up a Python debugger in VS Code for pytest</h3>
            
            <small class="text-muted">Published August 14, 2022</small>
        </div>

        <article>
            <h3 id="running-and-debugging-a-test-module-with-pytest-using-vs-code">Running and debugging a test module with pytest using VS Code</h3>
<p>You may be wondering how to set up the Python debugger in VS Code to debug pytest tests. Let us assume that you have opened a Python project in VS Code. In the following post, I specify some shortcuts to access certain UI elements of VS Code. These keyboard shortcuts are for MacOS. You can easily find the counterparts for the other operating systems with a quick web search. Also, I am going to reference several UI elements of VS Code as defined in their official documentation, which you can access here: <a href="https://code.visualstudio.com/docs/getstarted/userinterface">https://code.visualstudio.com/docs/getstarted/userinterface</a>. Let&rsquo;s get started:</p>
<ol>
<li>
<p>Go to the Activity Bar on the left and select &ldquo;Run and Debug (Shift+Command+D)&rdquo; (by default, it is the fourth item listed vertically in the bar).</p>
</li>
<li>
<p>Click on the underlined text &ldquo;create a launch.json file&rdquo;.</p>
</li>
<li>
<p>You are prompted with &ldquo;Select debugger&rdquo; in the quick input field at the top of the editor.</p>
<ol>
<li>Choose &ldquo;Python Debugger&rdquo;.</li>
<li>Next you are prompted for &ldquo;Debug Configuration&rdquo;. Select &ldquo;Python File&rdquo;.</li>
<li>A new configuration file (<code>launch.json</code>) is opened in the Editor.</li>
</ol>
</li>
<li>
<p>Note that you may have run the debugger before. In this case, in step 2 above, you will see a view with four sections by default (Variables, Watch, Call Stack, and Breakpoints).</p>
<ol>
<li>Right above the section &ldquo;Variables&rdquo; you will find a dropdown menu. Choose &ldquo;Add Configuration&hellip;&rdquo; from it.</li>
<li>The <code>launch.json</code> configuration file is opened and you are prompted with the same steps as listed in step 3 (apply them here too).</li>
</ol>
</li>
<li>
<p>Assuming you don&rsquo;t have any other configuration in the <code>launch.json</code> file, the contents should look like this:</p>
</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-JSON" data-lang="JSON"><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Use IntelliSense to learn about possible attributes.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">// Hover to view descriptions of existing attributes.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">// For more information, visit: https://go.microsoft.com/fwlink/?linkid=830387
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#f92672">&#34;version&#34;</span>: <span style="color:#e6db74">&#34;0.2.0&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;configurations&#34;</span>: [
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&#34;name&#34;</span>: <span style="color:#e6db74">&#34;Python Debugger: Current File&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&#34;type&#34;</span>: <span style="color:#e6db74">&#34;debugpy&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&#34;request&#34;</span>: <span style="color:#e6db74">&#34;launch&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&#34;program&#34;</span>: <span style="color:#e6db74">&#34;${file}&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&#34;console&#34;</span>: <span style="color:#e6db74">&#34;integratedTerminal&#34;</span>
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    ]
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><ul>
<li>
<p>The important part for us is the configuration named &ldquo;Python Debugger: Current File&rdquo; that has been added to the list of configurations. This is the minimal setup for debugging a regular Python script. Depending on which file is active in the Editor, it will debug that file (because <code>&quot;program&quot;: &quot;${file}&quot;</code>).</p>
</li>
<li>
<p>The variables in the configuration come from a list of predefined variables in VS Code. Here in the documentation (<a href="https://code.visualstudio.com/docs/editor/variables-reference#_predefined-variables">https://code.visualstudio.com/docs/editor/variables-reference#_predefined-variables</a>) you can find many more explained in detail.</p>
</li>
<li>
<p>For our purposes, to be able to run the debugger with pytest, i.e. the debugger should call the <code>pytest</code> module on the current test file, similar to running the command <code>pytest test.py</code> from the terminal, we need to edit some variables. They are as follows:</p>
</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-JSON" data-lang="JSON"><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// The name of the configuration,
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">// as it will be shown in the list from (cf. step 4.1).
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#f92672">&#34;name&#34;</span>: <span style="color:#e6db74">&#34;Pytest&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;type&#34;</span>: <span style="color:#e6db74">&#34;debugpy&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;request&#34;</span>: <span style="color:#e6db74">&#34;launch&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// We specify which module to run, whenever we run the debugger, 
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">// in this case it is `pytest`.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#f92672">&#34;module&#34;</span>: <span style="color:#e6db74">&#34;pytest&#34;</span>,  
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;console&#34;</span>: <span style="color:#e6db74">&#34;integratedTerminal&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// before, we specified the `$file` in the `program` attribute, 
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">// but since we added `module`, 
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">// the two are mutually exclusive (so only one of the attributes is permitted).
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#f92672">&#34;args&#34;</span>: [ <span style="color:#e6db74">&#34;${file}&#34;</span> ],
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// specifies the which python version from the system to use. 
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">// If your python version is in a virtual envrionment, then specify that path.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#f92672">&#34;python&#34;</span>: <span style="color:#e6db74">&#34;/usr/bin/python3.11&#34;</span>,
</span></span><span style="display:flex;"><span>}<span style="color:#960050;background-color:#1e0010">,</span>
</span></span></code></pre></div><p>The most important changes to the configuration are:</p>
<ul>
<li><code>program</code> attribute has been removed.</li>
<li><code>module</code> attribute has been added.</li>
<li>We specify the current file using the <code>args</code> attribute which accepts a list of arguments that will be appended when invoking the module <code>pytest</code>.</li>
</ul>
<p>Now you can select one of the test files, add breakpoints to it if necessary, and run the debugger for pytest (by pressing fn+F5 as a shortcut) or by clicking the green Play button in the drop-down menu with debugging configurations (cf. step 4.1).</p>
<h3 id="running-and-debugging-a-specific-test-with-pytest-using-vs-code">Running and debugging a specific test with pytest using VS Code</h3>
<p>If you&rsquo;d like to run and debug a specific test with pytest, you can add a new configuration, that contains the following, to the list of configurations in <code>launch.json</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-JSON" data-lang="JSON"><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;name&#34;</span>: <span style="color:#e6db74">&#34;Pytest specific test&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;type&#34;</span>: <span style="color:#e6db74">&#34;debugpy&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;request&#34;</span>: <span style="color:#e6db74">&#34;launch&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;module&#34;</span>: <span style="color:#e6db74">&#34;pytest&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;console&#34;</span>: <span style="color:#e6db74">&#34;integratedTerminal&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;args&#34;</span>: [
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;${file}::${command:pickArgs}&#34;</span>
</span></span><span style="display:flex;"><span>    ],
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;python&#34;</span>: <span style="color:#e6db74">&#34;/usr/bin/python3.11&#34;</span>,
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>As you know, in pytest you can run a specific test using the command <code>pytest test/test_my_module.py::my_test</code>. To do this in VS Code, we need to pass the current test file and the name of the test method we want to run.</p>
<p>VSCode provides <code>command:pickArgs</code> as a way to prompt you for the name of the test method each time you start the debug session (see more <a href="https://code.visualstudio.com/docs/python/debugging#_args">here</a>).</p>
<p>As a side note, if you already have a <code>launch.json</code>, you can add a new configuration either by manually creating a new JSON object in the configuration list, or by pressing the green button on the bottom right called &ldquo;Add Configuration&hellip;&rdquo; which will give you some useful prompts to quickly customize the configuration.</p>
<p>If you don&rsquo;t have a <code>launch.json</code>, follow the steps above, starting with step 1, to create one. Alternatively, advanced users can create the file and place it in <code>&lt;YOUR_PROJECT_ROOT&gt;/.vscode/</code>. The file should contain at least the following:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-JSON" data-lang="JSON"><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;version&#34;</span>: <span style="color:#e6db74">&#34;0.2.0&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;configurations&#34;</span>: [
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    ],
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div>
        </article>
    </div>

            </div>
        </div><footer class="text-center pb-1">
    <small class="text-muted">
        &copy; 2022-2024
        <br>
        Built with <a href="https://gohugo.io/" target="_blank">Hugo</a>
        based on <a href="https://github.com/austingebauer/devise" target="_blank">Devise</a>
        theme from <a href="https://github.com/austingebauer/devise" target="_blank">A. Gebauer.</a>
    </small>
</footer>
</body>
</html>
